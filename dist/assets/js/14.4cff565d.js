(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{168:function(s,t,n){"use strict";n.r(t);var a={props:["slot-key"],mounted:function(){this.$nextTick(function(){this.$vuepress.$emit("AsyncMarkdownContentMounted",this.slotKey)})}},e=n(4),o=Object(e.a)(a,function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.slotKey}},[n("h1",{attrs:{id:"child-process"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#child-process","aria-hidden":"true"}},[s._v("#")]),s._v(" child_process")]),s._v(" "),n("blockquote",[n("p",[s._v("child_process 模块,主要是用于衍生一个新的子进程.同步方法阻塞事件循环.")])]),s._v(" "),n("ul",[n("li",[s._v("child_process.spawn(command[, args][, options])")]),s._v(" "),n("li",[s._v("child_process.spawnSync()")]),s._v(" "),n("li",[s._v("child_process.exec(command[, options][, callback])")]),s._v(" "),n("li",[s._v("child_process.execSync()")]),s._v(" "),n("li",[s._v("child_process.execFile(file[, args][, options][, callback])")]),s._v(" "),n("li",[s._v("child_process.execFileSync()")]),s._v(" "),n("li",[s._v("child_process.fork(modulePath[, args][, options])")])]),s._v(" "),n("p",[s._v("大致就如上几个功能.从方法名可以看出一定的差异性.")]),s._v(" "),n("p",[s._v("child_process 在 windows 上衍生"),n("code",[s._v(".bat")]),s._v(","),n("code",[s._v(".cmd")]),s._v("来执行.在没有终端的情况下是不能执行这些文件的.")]),s._v(" "),n("p",[s._v("exec 和 execFile 提供的回调函数 callback (error, stdout, stderr)形式的.")]),s._v(" "),n("p",[s._v("错误,标准输出流,标准错误流.")]),s._v(" "),n("p",[s._v('args 指代的是参数列表,比如 node xx.js --name=tom, 那么这个 args 是"-name=tom",这个字符串参数列表.')]),s._v(" "),n("p",[s._v("options 中是一些"),n("code",[s._v("cwd")]),s._v(","),n("code",[s._v("env")]),s._v("之类的选项设置.see detail in "),n("a",{attrs:{href:"http://nodejs.cn/api/child_process.html#child_process_child_process_exec_command_options_callback",target:"_blank",rel:"noopener noreferrer"}},[s._v("this"),n("OutboundLink")],1)]),s._v(" "),n("p",[s._v("具体说一下 fork. fork 用于衍生一个新的子进程,在父进程和子进程使用 icp 通道进行通信.可以通过"),n("code",[s._v("message")]),s._v("事件进行消息的传递.")]),s._v(" "),n("p",[n("strong",[n("em",[s._v("in parent.js")])])]),s._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{attrs:{class:"token keyword"}},[s._v("const")]),s._v(" "),n("span",{attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" fork "),n("span",{attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),n("span",{attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{attrs:{class:"token function"}},[s._v("require")]),n("span",{attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{attrs:{class:"token string"}},[s._v("'child_process'")]),n("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{attrs:{class:"token keyword"}},[s._v("const")]),s._v(" parent_process "),n("span",{attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{attrs:{class:"token function"}},[s._v("fork")]),n("span",{attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{attrs:{class:"token string"}},[s._v("'./child.js'")]),n("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nparent_process"),n("span",{attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{attrs:{class:"token function"}},[s._v("on")]),n("span",{attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{attrs:{class:"token string"}},[s._v("'message'")]),n("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" m "),n("span",{attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),n("span",{attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  console"),n("span",{attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{attrs:{class:"token function"}},[s._v("log")]),n("span",{attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{attrs:{class:"token string"}},[s._v("'parent got name:'")]),s._v(" "),n("span",{attrs:{class:"token operator"}},[s._v("+")]),s._v(" m"),n("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("name"),n("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nparent_process"),n("span",{attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{attrs:{class:"token function"}},[s._v("send")]),n("span",{attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  name"),n("span",{attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{attrs:{class:"token string"}},[s._v("'parent'")]),n("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  message"),n("span",{attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{attrs:{class:"token string"}},[s._v("'i am parent'")]),s._v("\n"),n("span",{attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])])]),n("p",[n("strong",[n("em",[s._v("in child.js")])])]),s._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[s._v("process"),n("span",{attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{attrs:{class:"token function"}},[s._v("send")]),n("span",{attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  name"),n("span",{attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{attrs:{class:"token string"}},[s._v("'child'")]),n("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  message"),n("span",{attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{attrs:{class:"token string"}},[s._v("'i am child'")]),s._v("\n"),n("span",{attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nprocess"),n("span",{attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{attrs:{class:"token function"}},[s._v("on")]),n("span",{attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{attrs:{class:"token string"}},[s._v("'message'")]),n("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" m "),n("span",{attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),n("span",{attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  console"),n("span",{attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{attrs:{class:"token function"}},[s._v("log")]),n("span",{attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{attrs:{class:"token string"}},[s._v("'child got message:'")]),n("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" m"),n("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("message"),n("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])])]),n("p",[s._v("执行 parent.js,控制台输出什么呢?")]),s._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("child got message: i am parent\nparent got message: child\n")])])]),n("p",[s._v("在控制台输出的位置不一定是先 child 再 parent,根据文件内容而决定的输出顺序...跟事件循环机制有关.")]),s._v(" "),n("p",[s._v("然后最后强力推荐"),n("a",{attrs:{href:"https://github.com/shelljs/shelljs",target:"_blank",rel:"noopener noreferrer"}},[s._v("shelljs"),n("OutboundLink")],1)]),s._v(" "),n("p",[s._v("直接使用 shelljs 模块来写命令行代码.下一篇文章就写他.")]),s._v(" "),n("p",[s._v("当然如果想要写"),n("code",[s._v("命令脚本")]),s._v(",强力推荐"),n("a",{attrs:{href:"http://vorpal.js.org/",target:"_blank",rel:"noopener noreferrer"}},[s._v("vorpal"),n("OutboundLink")],1),s._v(".写起来真的是不要太简单.")])])},[],!1,null,null,null);o.options.__file="Child_Process.md";t.default=o.exports}}]);