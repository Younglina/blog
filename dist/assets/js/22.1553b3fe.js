(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{159:function(s,t,a){"use strict";a.r(t);var n={props:["slot-key"],mounted:function(){this.$nextTick(function(){this.$vuepress.$emit("AsyncMarkdownContentMounted",this.slotKey)})}},e=a(4),o=Object(e.a)(n,function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.slotKey}},[a("h1",{attrs:{id:"重读-vue-loader-文档"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#重读-vue-loader-文档","aria-hidden":"true"}},[s._v("#")]),s._v(" 重读 vue-loader 文档")]),s._v(" "),a("blockquote",[a("p",[s._v("今天要开启新的项目,想着脚手架页升级到 2.9.2 了,就准备试用一波,初始化完成后,发现配置有所删减和更新.对着文档重新翻阅了一遍.大致讲一讲和上一次看的差异性和收获.")])]),s._v(" "),a("h2",{attrs:{id:"src-imports"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#src-imports","aria-hidden":"true"}},[s._v("#")]),s._v(" "),a("a",{attrs:{href:"https://vue-loader.vuejs.org/en/start/spec.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("Src imports"),a("OutboundLink")],1)]),s._v(" "),a("p",[s._v("将.vue 文件分解.可以通过 src 属性引用已经编写好的块状代码,如 html 块,css 块,js 块.这个功能有点类似 nunjucks 中 extends,只不过他不是继承,只是引用一些共用的代码块.(模板),这对于 css 和 html 的友好性应该比定制化的 js 要强.")]),s._v(" "),a("p",[s._v("src 进口可以用于自定义块("),a("a",{attrs:{href:"https://vue-loader.vuejs.org/en/configurations/custom-blocks.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("Custom Block"),a("OutboundLink")],1),s._v(").")]),s._v(" "),a("h2",{attrs:{id:"custom-blocks"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#custom-blocks","aria-hidden":"true"}},[s._v("#")]),s._v(" "),a("a",{attrs:{href:"https://vue-loader.vuejs.org/en/configurations/custom-blocks.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("Custom Blocks"),a("OutboundLink")],1)]),s._v(" "),a("p",[s._v("自定义块的作用是定义一些非 template,script 以及 css 之外的块,块一般用作被自定义的 loader 解析.一般是 docs 块,用于书写该组件的说明文档.文档中采用的是使用"),a("code",[s._v("raw-loader")]),s._v("去解析自定义块.转成纯文本,然后提取到一个说明文档中.这个功能还有点作用,做项目的组件介绍的时候的确很有用!")]),s._v(" "),a("p",[s._v("自定义块除了这种功能,还有运行时可用的效果.什么意思,就是在 A 组件中定义了 docs 的块,在 B 组件中就可以拿到 docs 块被自己定义的 loader 解析之后的值.具体可以看文档的操作,值得一试.")]),s._v(" "),a("h2",{attrs:{id:"深度选择器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#深度选择器","aria-hidden":"true"}},[s._v("#")]),s._v(" 深度选择器")]),s._v(" "),a("p",[s._v("如果希望 scoped 中的样式选择是深度的,可以使用"),a("code",[s._v(".a >>> .b")]),s._v("的语法.")]),s._v(" "),a("p",[s._v("先说一下 postcss 对 scoped 的真实处理.")]),s._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{attrs:{class:"token operator"}},[s._v("<")]),s._v("style scoped lang"),a("span",{attrs:{class:"token operator"}},[s._v("=")]),a("span",{attrs:{class:"token string"}},[s._v('"scss"')]),a("span",{attrs:{class:"token operator"}},[s._v(">")]),s._v("\n  "),a("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("a"),a("span",{attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    color"),a("span",{attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" green"),a("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("b"),a("span",{attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      color"),a("span",{attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" red\n    "),a("span",{attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),a("span",{attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{attrs:{class:"token operator"}},[s._v("<")]),a("span",{attrs:{class:"token operator"}},[s._v("/")]),s._v("style"),a("span",{attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])])]),a("p",[s._v("在组件中经过 postcss 处理之后,假设作用的组件的每个节点都会被打上一个相同的 data-v-656039f0 标记.那么实际上 css 编译为")]),s._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{attrs:{class:"token comment"}},[s._v("// 实际的效果.")]),s._v("\n"),a("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("a"),a("span",{attrs:{class:"token punctuation"}},[s._v("[")]),s._v("data"),a("span",{attrs:{class:"token operator"}},[s._v("-")]),s._v("v"),a("span",{attrs:{class:"token operator"}},[s._v("-")]),a("span",{attrs:{class:"token number"}},[s._v("656039")]),s._v("f0"),a("span",{attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  color"),a("span",{attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" green"),a("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),a("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("a "),a("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("b"),a("span",{attrs:{class:"token punctuation"}},[s._v("[")]),s._v("data"),a("span",{attrs:{class:"token operator"}},[s._v("-")]),s._v("v"),a("span",{attrs:{class:"token operator"}},[s._v("-")]),a("span",{attrs:{class:"token number"}},[s._v("656039")]),s._v("f0"),a("span",{attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  color"),a("span",{attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" red"),a("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),a("p",[s._v("所以当我们想要通过.a 去控制属于里面的.b 时,在 scoped 中并不是我们想要的.")]),s._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("a"),a("span",{attrs:{class:"token punctuation"}},[s._v("[")]),s._v("data"),a("span",{attrs:{class:"token operator"}},[s._v("-")]),s._v("v"),a("span",{attrs:{class:"token operator"}},[s._v("-")]),a("span",{attrs:{class:"token number"}},[s._v("656039")]),s._v("f0"),a("span",{attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  color"),a("span",{attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" green"),a("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{attrs:{class:"token comment"}},[s._v("// 我们想要的效果")]),s._v("\n"),a("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("a"),a("span",{attrs:{class:"token punctuation"}},[s._v("[")]),s._v("data"),a("span",{attrs:{class:"token operator"}},[s._v("-")]),s._v("v"),a("span",{attrs:{class:"token operator"}},[s._v("-")]),a("span",{attrs:{class:"token number"}},[s._v("656039")]),s._v("f0"),a("span",{attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("b"),a("span",{attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  color"),a("span",{attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" red\n"),a("span",{attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),a("p",[s._v("但是动态渲染的内容是不会被打上 data-v-656039f0 标记的(postcss 是后处理,没办法对动态生成的内容做操作).")]),s._v(" "),a("p",[s._v("所以我们需要深度选择器,就是"),a("code",[s._v(".a >>> .b")])]),s._v(" "),a("p",[s._v("这样就能编译为我们要的 css 了.")]),s._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{attrs:{class:"token comment"}},[s._v("// 我们想要的效果")]),s._v("\n"),a("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("a"),a("span",{attrs:{class:"token punctuation"}},[s._v("[")]),s._v("data"),a("span",{attrs:{class:"token operator"}},[s._v("-")]),s._v("v"),a("span",{attrs:{class:"token operator"}},[s._v("-")]),a("span",{attrs:{class:"token number"}},[s._v("656039")]),s._v("f0"),a("span",{attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("b"),a("span",{attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{attrs:{class:"token comment"}},[s._v("// custom")]),s._v("\n"),a("span",{attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),a("p",[s._v("这个场景是之前一直需要的,虽然之前有上述的方式解决,既然提供了深度选择器,就可以直接使用了.")]),s._v(" "),a("h2",{attrs:{id:"loading-global-setting-file"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#loading-global-setting-file","aria-hidden":"true"}},[s._v("#")]),s._v(" loading global setting file")]),s._v(" "),a("p",[s._v("加载全局的 css 配置，在我们写 scss 时，经常想把一些 variable 定义在一个文件，还有一些通用的函数，这个时候不想在每个 vue 组件(通常是业务组件)中都去引用这个一样的定义文件，所以我们需要一个类似 webpack 的 global 设置的东西.去加载这个文件.")]),s._v(" "),a("p",[s._v("像 sass 使用的就是"),a("code",[s._v("sass-resources-loader")]),s._v(",在 vue-cli 搭建的环境中，loader 是被抽取在 util.js 中做统一处理的.")]),s._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  loader"),a("span",{attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v("'sass-resources-loader'")]),a("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  options"),a("span",{attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    resources"),a("span",{attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" path"),a("span",{attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{attrs:{class:"token function"}},[s._v("resolve")]),a("span",{attrs:{class:"token punctuation"}},[s._v("(")]),s._v("__dirname"),a("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v("'../src/assets/scss/mixin.scss'")]),a("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),a("span",{attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),a("p",[s._v("把需要自动加载的配置文件存放进去即可。（已经测试过了，有效果。）")]),s._v(" "),a("h2",{attrs:{id:"css-module"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#css-module","aria-hidden":"true"}},[s._v("#")]),s._v(" css module")]),s._v(" "),a("p",[s._v("这个就是通过一个变量能够直接访问到定义的 css 样式类名,通过 js 可以访问到这个特殊的模块 id.这个据文档介绍说是模拟 css scoped 的替代方案.")]),s._v(" "),a("p",[s._v("就我个人感觉,实用程度和我直接使用 scoped 操作没什么很大区别.")]),s._v(" "),a("h2",{attrs:{id:"postcss"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#postcss","aria-hidden":"true"}},[s._v("#")]),s._v(" "),a("a",{attrs:{href:"https://github.com/postcss/postcss",target:"_blank",rel:"noopener noreferrer"}},[s._v("postcss"),a("OutboundLink")],1)]),s._v(" "),a("p",[s._v("这个之前有用过,对具体的功能配置,还是要熟悉一下 postcss 的开发和认知.这个可以补一下~")]),s._v(" "),a("p",[s._v("在 loader 的环节,比如使用 postcss-cssnext,使用 sugarss,")]),s._v(" "),a("h2",{attrs:{id:"hotreload"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#hotreload","aria-hidden":"true"}},[s._v("#")]),s._v(" "),a("a",{attrs:{href:"https://vue-loader.vuejs.org/en/features/hot-reload.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("hotReload"),a("OutboundLink")],1)]),s._v(" "),a("p",[s._v("对于热重载不陌生了,这次主要是更新将以前通过 node 方式启动 express 服务,然后利用 webpack-dev-server,hot-middle-ware 等中间件作为开发环境的配置转成了单独使用 webpack-dev-server 作为开发环境的启动,将 webpack.dev.conf.js(开发环境配置)作为配置项的方式.")]),s._v(" "),a("p",[s._v("hotReload 此次也更新为可配置的,可以手动关闭.当然在 ssr 的环境,生产环境时,默认的 hotReload 是禁用的.")]),s._v(" "),a("h2",{attrs:{id:"cachebusting"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#cachebusting","aria-hidden":"true"}},[s._v("#")]),s._v(" cacheBusting")]),s._v(" "),a("p",[s._v("缓存无效化,将 hash 关闭之后,有利于帮助源码调试.")]),s._v(" "),a("p",[s._v("但是具体的效果我没有在哪里可以看到,待实践.")]),s._v(" "),a("h2",{attrs:{id:"esmodule"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#esmodule","aria-hidden":"true"}},[s._v("#")]),s._v(" esModule")]),s._v(" "),a("p",[s._v("关于默认的导出是 es module 的导出方式..具体看"),a("a",{attrs:{href:"https://github.com/vuejs/vue-loader/releases/tag/v13.0.0",target:"_blank",rel:"noopener noreferrer"}},[s._v("V13.0.0"),a("OutboundLink")],1)]),s._v(" "),a("p",[s._v("在新的 vue-loader 版本,esModule 默认是 true 的,为了打包更小的体积(配合 webpack3),在高版本的动态导入不需要使用"),a("code",[s._v(".default")]),s._v(",因为 vue-loader 已经帮忙做处理了.")]),s._v(" "),a("p",[a("img",{attrs:{src:"/blog/image/%E9%87%8D%E8%AF%BBvue-loader%E6%96%87%E6%A1%A3_1.png",alt:""}})]),s._v(" "),a("p",[s._v("观察 vue-loader 对.vue 文件的处理,还是能看出蛮多东西的.")])])},[],!1,null,null,null);o.options.__file="Study vue-loader.md";t.default=o.exports}}]);